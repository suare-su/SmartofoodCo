import requests
import json
import re
import datetime
import time
label = ''
headers = {'Content-Type': 'application/json', 'charset': 'utf-8'}
authorization_url = 'https://api-ru.iiko.services/api/1/access_token'
data = {
    "apiLogin": "8825f00c" # client novgorod
}
data = {
    "apiLogin": "fa7202f0" # client
}
data = {
    "apiLogin": "a9a4d21e-a51" # тест
}
data = {
    "apiLogin": "7ff5cfa5" # тест
}
token = requests.post(url=authorization_url, headers=headers, data=json.dumps(data)).json()['token']
print("TOKEN: ",token)

headers = {'Content-Type': 'application/json', 'charset': 'utf-8', 'Authorization':'Bearer %s' % token}
data = {}
org_url = 'https://api-ru.iiko.services/api/1/organizations'
ORGANIZATION_IDS = [org['id'] for org in requests.post(url=org_url, headers=headers, data=json.dumps(data)).json()['organizations']]
print("ORGANIZATIONS: ", ORGANIZATION_IDS)

ORGANIZATION_IDS

terminals_url = 'https://api-ru.iiko.services/api/1/terminal_groups'
data = {
    'organizationIds': ORGANIZATION_IDS,
}
TERMINGAL_GROUPS_IDS_RAW = requests.post(url=terminals_url, headers=headers, data=json.dumps(data)).json()['terminalGroups']
print(TERMINGAL_GROUPS_IDS_RAW)

#[{'organizationId': 'b9eede12-44d1-4eaf-9724-1fa9237be4da',
# 'items': [{'id': '48fd91da-ec50-41ab-8a1c-aedcfd96da27', 'organizationId': 'b9eede12-44d1-4eaf-9724-1fa9237be4da',
# 'name': 'Group Cute Badger', 'address': ''}]}]
url = 'https://api-ru.iiko.services/api/1/reserve/available_restaurant_sections'
tables = ["3be7ca30-51a0-445b-adae-4f7c013c9322",
          "52608190-5517-419e-9c87-af8eb321e671",
          "bac01c5d-56d7-4d8f-afe7-4b18660da2f4",
          "18c09cd2-5881-4194-810a-862a3bf01c61",
          "73af7ca2-f67d-4923-8539-f3da7cb2c1f8",]
data = {
    'terminalGroupIds': ['2ffb705b-d3d0-2400-017a-7ae49b7200cf'],
    'returnSchema': True,
}
response = requests.post(url=url, headers=headers, data=json.dumps(data)).json()
print(json.dumps(response))
#{"correlationId": "7bdfb90c-fd43-475d-8e7e-2ff5cb5f165a", "restaurantSections": [{"id": "c81d715e-8e52-4865-bd69-bede1e0350be", "terminalGroupId": "2ffb705b-d3d0-2400-017a-7ae49b7200cf", "name": "\u0411\u0430\u0440  (\u041c\u0438\u043b\u044b\u0439 \u0431\u0430\u0440\u0441\u0443\u043a)", "tables": [{"id": "3be7ca30-51a0-445b-adae-4f7c013c9322", "number": 1, "name": "\u0421\u0442\u043e\u043b 1", "seatingCapacity": 0, "revision": 1661251956150, "isDeleted": false}, {"id": "52608190-5517-419e-9c87-af8eb321e671", "number": 2, "name": "\u0421\u0442\u043e\u043b 2", "seatingCapacity": 0, "revision": 1661251956150, "isDeleted": false}, {"id": "bac01c5d-56d7-4d8f-afe7-4b18660da2f4", "number": 3, "name": "\u0421\u0442\u043e\u043b 3", "seatingCapacity": 0, "revision": 1661251956150, "isDeleted": false}, {"id": "18c09cd2-5881-4194-810a-862a3bf01c61", "number": 4, "name": "\u0421\u0442\u043e\u043b 4", "seatingCapacity": 0, "revision": 1661251956150, "isDeleted": false}, {"id": "73af7ca2-f67d-4923-8539-f3da7cb2c1f8", "number": 5, "name": "\u0421\u0442\u043e\u043b 5", "seatingCapacity": 0, "revision": 1661251956150, "isDeleted": false}, {"id": "7c5973fd-6cca-4bd0-a3bb-aa2842729f56", "number": 6, "name": "\u0421\u0442\u043e\u043b 6", "seatingCapacity": 0, "revision": 1661251956150, "isDeleted": false}, {"id": "24538524-c877-47cb-95a3-7341a6bbaded", "number": 7, "name": "\u0421\u0442\u043e\u043b 7", "seatingCapacity": 0, "revision": 1661251956150, "isDeleted": false}, {"id": "aaabc6ac-6e29-4dbc-a38b-1db531ac2358", "number": 8, "name": "\u0421\u0442\u043e\u043b 8", "seatingCapacity": 0, "revision": 1661251956150, "isDeleted": false}, {"id": "d4d1b6c2-0421-452c-a302-e31bd4f7ab3c", "number": 9, "name": "\u0421\u0442\u043e\u043b 9", "seatingCapacity": 0, "revision": 1661251956150, "isDeleted": false}, {"id": "86f39a68-1987-4884-91e2-0380023eed63", "number": 10, "name": "\u0421\u0442\u043e\u043b 10", "seatingCapacity": 0, "revision": 1661251956150, "isDeleted": false}], "schema": {"width": 810, "height": 550, "markElements": [], "tableElements": [{"tableId": "aaabc6ac-6e29-4dbc-a38b-1db531ac2358", "x": 13, "y": 648, "z": 7, "angle": 0.0, "width": 80, "height": 80}, {"tableId": "73af7ca2-f67d-4923-8539-f3da7cb2c1f8", "x": 296, "y": 446, "z": 4, "angle": 0.0, "width": 80, "height": 80}, {"tableId": "24538524-c877-47cb-95a3-7341a6bbaded", "x": 156, "y": 443, "z": 6, "angle": 0.0, "width": 80, "height": 80}, {"tableId": "3be7ca30-51a0-445b-adae-4f7c013c9322", "x": 47, "y": 117, "z": 0, "angle": 0.0, "width": 80, "height": 80}, {"tableId": "18c09cd2-5881-4194-810a-862a3bf01c61", "x": 316, "y": 588, "z": 3, "angle": 0.0, "width": 164, "height": 164}, {"tableId": "bac01c5d-56d7-4d8f-afe7-4b18660da2f4", "x": 185, "y": 122, "z": 2, "angle": 0.0, "width": 80, "height": 80}, {"tableId": "d4d1b6c2-0421-452c-a302-e31bd4f7ab3c", "x": 404, "y": 349, "z": 8, "angle": 0.0, "width": 80, "height": 80}, {"tableId": "86f39a68-1987-4884-91e2-0380023eed63", "x": 120, "y": 698, "z": 9, "angle": 0.0, "width": 80, "height": 80}, {"tableId": "52608190-5517-419e-9c87-af8eb321e671", "x": 94, "y": 285, "z": 1, "angle": 0.0, "width": 80, "height": 80}, {"tableId": "7c5973fd-6cca-4bd0-a3bb-aa2842729f56", "x": 231, "y": 267, "z": 5, "angle": 0.0, "width": 80, "height": 80}], "rectangleElements": [], "ellipseElements": [], "revision": 1661252736159, "isDeleted": false}}, {"id": "33cd2a98-668b-405f-ac54-16b2fe0e5522", "terminalGroupId": "2ffb705b-d3d0-2400-017a-7ae49b7200cf", "name": "\u0417\u0430\u043b  (\u041c\u0438\u043b\u044b\u0439 \u0431\u0430\u0440\u0441\u0443\u043a)", "tables": [{"id": "fae3005e-a40c-4e9b-8d2b-120890c47ea4", "number": 11, "name": "\u0421\u0442\u043e\u043b 1", "seatingCapacity": 0, "revision": 1661251956150, "isDeleted": false}, {"id": "79d9c72a-f7e7-498d-908f-195ce148d403", "number": 12, "name": "\u0421\u0442\u043e\u043b 2", "seatingCapacity": 0, "revision": 1661251956150, "isDeleted": false}, {"id": "837b9041-c43e-4c44-a379-e64442fa010e", "number": 13, "name": "\u0421\u0442\u043e\u043b 3", "seatingCapacity": 8, "revision": 1661251956150, "isDeleted": false}, {"id": "18a503bb-8e44-4d76-82c2-f7e295fb760e", "number": 14, "name": "", "seatingCapacity": 0, "revision": 1661251956150, "isDeleted": false}, {"id": "61ce1d7b-5dcf-424b-af06-c263bc448445", "number": 15, "name": "", "seatingCapacity": 0, "revision": 1661251956150, "isDeleted": false}, {"id": "2b60a0f9-a156-4051-90b2-9591e4db462e", "number": 16, "name": "", "seatingCapacity": 0, "revision": 1661251956150, "isDeleted": false}, {"id": "a8b58904-ea16-4333-8141-2dd0fe425f17", "number": 17, "name": "", "seatingCapacity": 0, "revision": 1661251956150, "isDeleted": false}, {"id": "18e4a310-f812-48b4-9dfd-53f5903a6aa8", "number": 18, "name": "", "seatingCapacity": 0, "revision": 1661251956150, "isDeleted": false}, {"id": "d285660a-a224-48b6-a316-da647f19d2a8", "number": 19, "name": "", "seatingCapacity": 0, "revision": 1661251956150, "isDeleted": false}, {"id": "33dbf125-8ad0-4eb0-ac86-3908dd6a6073", "number": 20, "name": "", "seatingCapacity": 0, "revision": 1661251956150, "isDeleted": false}, {"id": "461d2150-eb74-4482-a04e-3d36b4cc70db", "number": 21, "name": "", "seatingCapacity": 0, "revision": 1661251956150, "isDeleted": false}, {"id": "874e69a4-7f4e-4d55-816d-9f788d54747e", "number": 22, "name": "", "seatingCapacity": 0, "revision": 1661251956150, "isDeleted": false}, {"id": "87b359d1-8050-4efa-8a72-21719465754b", "number": 23, "name": "", "seatingCapacity": 0, "revision": 1661251956150, "isDeleted": false}, {"id": "45c8dfe7-5e2a-446a-a5b2-e871af04959f", "number": 24, "name": "", "seatingCapacity": 0, "revision": 1661251956150, "isDeleted": false}, {"id": "e680cc92-7091-46e9-a5a0-aa834cc52500", "number": 25, "name": "", "seatingCapacity": 0, "revision": 1661251956150, "isDeleted": false}, {"id": "e69c42e7-9db6-480b-af6e-21e7f164c512", "number": 26, "name": "", "seatingCapacity": 0, "revision": 1661251956150, "isDeleted": false}, {"id": "3e7f3b86-6e3b-4711-a69c-10768f886052", "number": 27, "name": "", "seatingCapacity": 0, "revision": 1661251956150, "isDeleted": false}, {"id": "36ff80b0-3a4e-4ac6-ba84-692b831ab8f0", "number": 28, "name": "", "seatingCapacity": 0, "revision": 1661251956150, "isDeleted": false}, {"id": "02deb9d3-b8c8-44ab-aca7-f4c0b66ffc36", "number": 29, "name": "", "seatingCapacity": 0, "revision": 1661251956150, "isDeleted": false}, {"id": "4198ead6-da58-4d98-b9d2-01bc839f54ed", "number": 30, "name": "", "seatingCapacity": 0, "revision": 1661251956150, "isDeleted": false}], "schema": {"width": 810, "height": 550, "markElements": [{"text": "\u0422\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0441\u0442\u043e\u043b", "font": {"fontFamily": "Arial", "size": 18.0, "fontStyle": "Regular"}, "color": {"a": 0, "r": 255, "g": 0, "b": 0}, "x": 509, "y": 147, "z": 23, "angle": 0.0, "width": 201, "height": 42}, {"text": "\u0414\u043b\u0438\u043d\u043d\u044b\u0439 \u0441\u0442\u043e\u043b", "font": {"fontFamily": "Arial", "size": 24.0, "fontStyle": "Regular"}, "color": {"a": 0, "r": 0, "g": 0, "b": 255}, "x": 465, "y": 557, "z": 18, "angle": 0.0, "width": 217, "height": 42}, {"text": "\u0422\u0430\u043d\u0446\u043f\u043e\u043b", "font": {"fontFamily": "Arial", "size": 24.0, "fontStyle": "Regular"}, "color": {"a": 0, "r": 0, "g": 11, "b": 255}, "x": 257, "y": 583, "z": 20, "angle": 0.0, "width": 127, "height": 42}, {"text": "\u0411\u0430\u0440\u043d\u0430\u044f \u0441\u0442\u043e\u0439\u043a\u0430", "font": {"fontFamily": "Arial", "size": 24.0, "fontStyle": "Regular"}, "color": {"a": 0, "r": 255, "g": 0, "b": 0}, "x": 34, "y": 508, "z": 4, "angle": 0.0, "width": 220, "height": 42}], "tableElements": [{"tableId": "3e7f3b86-6e3b-4711-a69c-10768f886052", "x": 123, "y": 599, "z": 8, "angle": 0.0, "width": 40, "height": 40}, {"tableId": "837b9041-c43e-4c44-a379-e64442fa010e", "x": 19, "y": 208, "z": 12, "angle": 0.0, "width": 80, "height": 80}, {"tableId": "61ce1d7b-5dcf-424b-af06-c263bc448445", "x": 115, "y": 21, "z": 13, "angle": 0.0, "width": 80, "height": 80}, {"tableId": "18e4a310-f812-48b4-9dfd-53f5903a6aa8", "x": 110, "y": 301, "z": 16, "angle": 0.0, "width": 80, "height": 80}, {"tableId": "e680cc92-7091-46e9-a5a0-aa834cc52500", "x": 123, "y": 511, "z": 10, "angle": 0.0, "width": 40, "height": 40}, {"tableId": "2b60a0f9-a156-4051-90b2-9591e4db462e", "x": 114, "y": 120, "z": 14, "angle": 0.0, "width": 80, "height": 80}, {"tableId": "e69c42e7-9db6-480b-af6e-21e7f164c512", "x": 123, "y": 556, "z": 9, "angle": 0.0, "width": 40, "height": 40}, {"tableId": "79d9c72a-f7e7-498d-908f-195ce148d403", "x": 19, "y": 117, "z": 2, "angle": 0.0, "width": 80, "height": 80}, {"tableId": "45c8dfe7-5e2a-446a-a5b2-e871af04959f", "x": 434, "y": 160, "z": 22, "angle": 0.0, "width": 80, "height": 80}, {"tableId": "461d2150-eb74-4482-a04e-3d36b4cc70db", "x": 441, "y": 520, "z": 17, "angle": 0.0, "width": 266, "height": 84}, {"tableId": "02deb9d3-b8c8-44ab-aca7-f4c0b66ffc36", "x": 121, "y": 693, "z": 6, "angle": 0.0, "width": 40, "height": 40}, {"tableId": "4198ead6-da58-4d98-b9d2-01bc839f54ed", "x": 123, "y": 741, "z": 5, "angle": 0.0, "width": 40, "height": 40}, {"tableId": "18a503bb-8e44-4d76-82c2-f7e295fb760e", "x": 21, "y": 301, "z": 11, "angle": 0.0, "width": 80, "height": 80}, {"tableId": "a8b58904-ea16-4333-8141-2dd0fe425f17", "x": 113, "y": 210, "z": 15, "angle": 0.0, "width": 80, "height": 80}, {"tableId": "36ff80b0-3a4e-4ac6-ba84-692b831ab8f0", "x": 120, "y": 645, "z": 7, "angle": 0.0, "width": 40, "height": 40}, {"tableId": "fae3005e-a40c-4e9b-8d2b-120890c47ea4", "x": 19, "y": 24, "z": 1, "angle": 0.0, "width": 80, "height": 80}], "rectangleElements": [{"color": {"a": 0, "r": 0, "g": 0, "b": 0}, "x": -9, "y": 433, "z": 3, "angle": 0.0, "width": 386, "height": 123}], "ellipseElements": [{"color": {"a": 0, "r": 0, "g": 255, "b": 255}, "x": 180, "y": 550, "z": 19, "angle": 0.0, "width": 189, "height": 189}], "revision": 1661252736159, "isDeleted": false}}], "revision": 1661252736159}
#"id": "3be7ca30-51a0-445b-adae-4f7c013c9322", "number": 1, "name": "\u0421\u0442\u043e\u043b 1"

create_order_url = 'https://api-ru.iiko.services/api/1/order/create'
